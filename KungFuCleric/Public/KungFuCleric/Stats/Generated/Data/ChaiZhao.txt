// 乾坤大挪移 (法术反制)
new entry "Passive_KFC_QianKunDaNuoYi"
type "PassiveData"
data "DisplayName" "h86d88fd1g5817g4239gae61gdc97ceabc9a8;1"
data "Description" "h308cec68gda29g40e5gae76g5f53aa842295;1"
// 法术反制
data "Icon" "PassiveFeature_Counterspell"
data "Properties" "Highlighted"
data "Boosts" "ActionResource(ReactionActionPoint,2,0);UnlockInterrupt(Interrupt_KFC_Counterspell)"

new entry "Interrupt_KFC_Counterspell"
type "InterruptData"
data "DisplayName" "hc130da9ag9b81g4108gbda6g35abdfe0a510;1"
data "Description" "he57bf83egac0cg46dfga37ag7474c1550ff2;1"
data "DescriptionParams" "Distance(18)"
// 灵能统御
data "Icon" "TadpoleSuperPower_PsionicDominance"
data "InterruptContext" "OnSpellCast"
data "InterruptContextScope" "Nearby"
data "Container" "YesNoDecision"
// 允许反应、可反应、未被沉默、是敌人、非自己、是角色、是法术、法术等级小于等于熟练度判断、非武器攻击
data "Conditions" "IsAbleToReact(context.Observer) and not Uninterruptible() and not HasSpellCastBlocked(context.Observer) and Enemy(context.Source,context.Observer) and not Self(context.Source,context.Observer) and not AnyEntityIsItem() and IsSpell() and SpellPowerLevelEqualOrLessThan(context.Observer.ProficiencyBonus) and not HasStringInSpellRoll('WeaponAttack')"
data "Properties" "Counterspell()"
data "Cost" "ReactionActionPoint:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER') or HasStatus('SG_Disguise')"
data "EnableContext" "OnStatusApplied;OnStatusRemoved"

// 太极拳 (反击)
new entry "Passive_KFC_TaiJiQuan"
type "PassiveData"
data "DisplayName" "hbf516c35gaed3g48dfgb6b0g5df4a1b9315c;1"
data "Description" "h846722bag6b61g4b9fgac2agd4670d0f76eb;1"
// 魔法抗性
data "Icon" "PassiveFeature_Generic_Magical"
data "Properties" "Highlighted"
data "Boosts" "ActionResource(ReactionActionPoint,2,0);IF(not HasStatus('INCAPACITATED_DND')):UnlockInterrupt(Interrupt_KFC_Riposte);UnlockSpell(Target_KFC_Shove)"

new entry "Interrupt_KFC_Riposte"
type "InterruptData"
data "DisplayName" "hbf516c35gaed3g48dfgb6b0g5df4a1b9315c;1"
data "Description" "hea0b19beg0157g44ddgac81g9beb70e4f73f;1"
// 百病不侵
data "Icon" "PassiveFeature_PurityOfBody"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Self"
data "Container" "YesNoDecision"
// 允许反应、是敌人、是角色、触发攻击、是近战、距离2以内、未隐身
data "Conditions" "IsAbleToReact(context.Observer) and Enemy(context.Source,context.Observer) and not AnyEntityIsItem() and HasLastAttackTriggered() and IsMeleeAttack() and not DistanceToEntityGreaterThan(2,context.ObserverPosition,context.Source) and not HasStatus('INVISIBILITY')"
data "Properties" "UseAttack(SWAP);ApplyStatus(OBSERVER_OBSERVER,INTERRUPT_KFC_RIPOSTE,100,0)"
data "Cost" "ReactionActionPoint:1"
data "InterruptDefaultValue" "Enabled"
data "EnableCondition" "not HasAnyStatus({'SG_Polymorph','SG_Blinded'}) or Tagged('MINDFLAYER') or HasStatus('SG_Disguise')"
data "EnableContext" "OnStatusApplied;OnStatusRemoved"

new entry "INTERRUPT_KFC_RIPOSTE"
type "StatusData"
data "StatusType" "EFFECT"
data "DisplayName" "hbf516c35gaed3g48dfgb6b0g5df4a1b9315c;1"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "StatusEffect" "ec81657b-9e78-49d9-83a0-47a7ad2a1753"

// 太极劲 (推击)
new entry "Target_KFC_Shove"
type "SpellData"
data "SpellType" "Target"
data "SpellProperties" "RemoveStatus(SLEEP);RemoveStatus(SLEEPING);RemoveStatus(SG_Sleeping);"
data "TargetCeiling" "0"
data "TargetFloor" ".25"
data "TargetRadius" "6"
data "SpellRoll" "ShoveCheck()"
data "SpellSuccess" "IF(not Ally()):Force(ShoveDistance,OriginToEntity,Aggressive);IF(Ally()):Force(ShoveDistance,OriginToEntity,Friendly);DealDamage(1d8+UnarmedDamage+max(1,DexterityModifier),Bludgeoning);IF(not SavingThrow(Ability.Dexterity,18)):ApplyStatus(PRONE,100,1)"
data "TooltipDamageList" "DealDamage(1d8+UnarmedDamage+max(1,DexterityModifier),Bludgeoning)"
data "TargetConditions" "not Self() and CanShoveWeight() and IsMovable() and not Grounded() and not Tagged('GASEOUS_FORM') and not (not Player(context.Source) and Combat(context.Source) and Character() and not (Enemy() or HasStatus('SG_Unconscious'))) and not Tagged('CANT_SHOVE_THROW')"
// 共鸣之气
data "Icon" "Action_KiResonation_Punch"
data "DisplayName" "hf9269375gc6f5g44eagae79g2a361a0ebb75;1"
data "Description" "h3921ea48g1ac9g4310gbd52gb7041dcee29f;7"
data "DescriptionParams" "DealDamage(1d8+UnarmedDamage+max(1,DexterityModifier),Bludgeoning);18;1"
data "ExtraDescription" "h0907f7c8g694cg45c2ga77fg06cc883b7a9d;1"
data "PrepareSound" "Generic_GeneralAction_Start"
data "PrepareLoopSound" "Generic_GeneralAction_Loop"
data "CastSound" "Action_Cast_Shove"
data "PreviewCursor" "Melee"
data "CastTextEvent" "Cast"
data "CycleConditions" "CanShoveWeight() and not Grounded()"
data "UseCosts" "BonusActionPoint:1"
data "SpellAnimation" "8b8bb757-21ce-4e02-a2f3-97d55cf2f90b,,;6606c30b-be1c-4f17-ae6b-1a591c80b18c,,;f4ac302b-1569-404f-bd52-1fe443e265df,,;e8a5c57f-855b-4227-acaa-11e8ce8d7d64,,;7bb52cd4-0b1c-4926-9165-fa92b75876a3,,;2b81c18b-9698-4262-a623-932c2bb1296d,,;0b07883a-08b8-43b6-ac18-84dc9e84ff50,,;,,;,,"
data "VerbalIntent" "Utility"
data "SpellFlags" "IsHarmful;IsMelee;AddFallDamageOnLand;HasHighGroundRangeExtension;RangeIgnoreVerticalThreshold;CombatLogSetSingleLineRoll"
data "SpellActionType" "Shove"
data "HitAnimationType" "PhysicalDamage"
data "SpellAnimationIntentType" "Peaceful"
data "PrepareEffect" "c512042e-a04f-4a02-af7a-16f30e11ed95"
data "CastEffect" "3a66dd23-61fe-4716-a8af-69d85bff09b7"
data "TargetEffect" "5d8c64e3-f9ff-4ee0-b0b6-2a081c7244a8"
data "SpellSoundMagnitude" "Small"
data "Sheathing" "Sheathed"
