// 金刚不坏神功
new entry "Passive_KFC_JinGangBuHuaiShenGong"
type "PassiveData"
data "DisplayName" "hb5884a09g33c0g4908ga7d1g1c277630bfd5;1"
data "Description" "h58031c2dgb037g493fgab67g50139ff50c99;1"
data "DescriptionParams" "max(1,ConstitutionModifier)"
// 无甲防御：野蛮人
data "Icon" "PassiveFeature_UnarmoredDefense_Barbarian"
data "Properties" "Highlighted"
data "Boosts" "ACOverrideFormula(13,true,Dexterity,Constitution);DamageReduction(Piercing,Flat,max(1,ConstitutionModifier));DamageReduction(Bludgeoning,Flat,max(1,ConstitutionModifier));DamageReduction(Slashing,Flat,max(1,ConstitutionModifier));DamageReduction(Force,Flat,max(1,ConstitutionModifier));Advantage(Ability,Constitution);UnlockSpell(Shout_KFC_AuraOf_Protection);UnlockInterrupt(Interrupt_KFC_Shield);UnlockSpell(Shout_KFC_Shield);UnlockSpell(Shout_KFC_ResilientSphere)"

// 金钟罩（守护灵光）
new entry "Shout_KFC_AuraOf_Protection"
type "SpellData"
data "SpellType" "Shout"
data "SpellProperties" "ApplyStatus(KFC_AURA_OF_PROTECTION,100,-1);"
data "TooltipStatusApply" "ApplyStatus(KFC_AURA_OF_PROTECTION,100,-1);"
data "AreaRadius" "18"
data "TargetConditions" "Self()"
data "Icon" "Action_Paladin_AuraOfProtection"
data "DisplayName" "hcebcd611gaa70g4854gaeafg191511ecd8d5;1"
data "Description" "hf695d1a4g3cfcg4353gaacdg9080f7d81d38;1"
data "DescriptionParams" "Distance(18);max(1,Cause.ConstitutionModifier)"
data "ExtraDescription" ""
data "CastSound" "Spell_Cast_Paladin_AuraOfProtection_L1to3"
data "TargetSound" "Spell_Impact_Paladin_AuraOfProtection_L1to3"
data "PreviewCursor" "Cast"
data "CastTextEvent" "Cast"
data "SpellAnimation" "83fb0115-57dd-4cce-ac40-87182b2865e2,,;,,;62e74220-ba87-4fe7-aa99-9d12cab9d654,,;b1f3f86a-a1fc-43f6-8a2b-0110a9f99ead,,;42014429-21fb-412d-bba6-0f8216f5e502,,;,,;43fa5e31-ad7e-47a9-9ca2-f6d40ba8e1cf,,;,,;,,"
data "VerbalIntent" "Buff"
data "SpellStyleGroup" "Class"
data "RequirementConditions" "not HasStatus('KFC_AURA_OF_PROTECTION')"
data "PrepareEffect" "c218f05b-1e12-4298-beff-e4d33a5fa5a5"
data "CastEffect" "8265c6d6-662a-40fe-888b-024af0e2b1b9"

new entry "KFC_AURA_OF_PROTECTION"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hcebcd611gaa70g4854gaeafg191511ecd8d5;1"
data "Description" "hf695d1a4g3cfcg4353gaacdg9080f7d81d38;1"
data "DescriptionParams" "Distance(18);max(1,Cause.ConstitutionModifier)"
data "Icon" "Action_Paladin_AuraOfProtection"
data "StackId" "KFC_AURA_OF_PROTECTION"
data "StackPriority" "10"
data "AuraRadius" "18"
data "AuraStatuses" "IF(Ally() and not Tagged('INANIMATE')):ApplyStatus(KFC_AURA_OF_PROTECTION_BUFF)"
data "Boosts" "RollBonus(SavingThrow,max(1,Cause.ConstitutionModifier));RollBonus(DeathSavingThrow,max(1,Cause.ConstitutionModifier))"
data "RemoveConditions" "HasStatus('SG_Incapacitated')"
data "RemoveEvents" "OnStatusApplied"
data "StatusPropertyFlags" "IgnoreResting"
data "StatusGroups" "SG_RemoveOnRespec"

new entry "KFC_AURA_OF_PROTECTION_BUFF"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hcebcd611gaa70g4854gaeafg191511ecd8d5;1"
data "Description" "hf695d1a4g3cfcg4353gaacdg9080f7d81d38;1"
data "DescriptionParams" "Distance(18);max(1,Cause.ConstitutionModifier)"
data "Icon" "Action_Paladin_AuraOfProtection"
data "StackId" "KFC_AURA_OF_PROTECTION"
data "StackPriority" "5"
data "Boosts" "RollBonus(SavingThrow,max(1,Cause.ConstitutionModifier));RollBonus(DeathSavingThrow,max(1,Cause.ConstitutionModifier))"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog"
data "StatusGroups" "SG_RemoveOnRespec"
data "ApplyEffect" "d21494e5-5c30-4a69-85ef-75a785e71105"
data "EndEffect" "a5c11e94-efa3-4998-a76b-fc12502ea565"

// 铁布衫（护盾术）
new entry "Interrupt_KFC_Shield"
type "InterruptData"
data "DisplayName" "hd2aa6de7g6596g45c4gbcdbg8307d584920f;1"
data "Description" "h59dfaff5gfd53g4de4gba58ge5fd85887972;1"
data "DescriptionParams" "5"
data "Icon" "PassiveFeature_Shield"
data "InterruptContext" "OnPostRoll;OnPreDamage"
data "InterruptContextScope" "Self"
data "Container" "YesNoDecision"
// 允许反应、目标是自己、不是物品、状态并非已存在、中断攻击值大于5或是魔法飞弹
data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Target,context.Observer) and not AnyEntityIsItem() and not HasStatus('KFC_SHIELD',context.Observer) and ((HasInterruptedAttack() and IsFlatValueInterruptInteresting(5,context.Source)) or IsSpellChildOrVariantFromContext('Projectile_MagicMissile'))"
data "Properties" "IF(HasInterruptedAttack()):AdjustRoll(-5);IF(IsSpellChildOrVariantFromContext('Projectile_MagicMissile')):SetRoll(0);ApplyStatus(KFC_INTERRUPT_SHIELD,100,1);ApplyStatus(OBSERVER_OBSERVER,KFC_SHIELD,100,1)"
data "Cost" "ReactionActionPoint:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER') or HasStatus('SG_Disguise')"
data "EnableContext" "OnStatusApplied;OnStatusRemoved"

new entry "KFC_INTERRUPT_SHIELD"
type "StatusData"
data "StatusType" "EFFECT"
data "DisplayName" "hd2aa6de7g6596g45c4gbcdbg8307d584920f;1"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "TickType" "StartTurn"
data "StatusEffect" "4b19b349-e105-43dc-85bd-68acb958b8d8"

new entry "KFC_SHIELD"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hd2aa6de7g6596g45c4gbcdbg8307d584920f;1"
data "Description" "hd3f2a30cg933cg4e95ga3deg55989e394873;1"
data "Icon" "Spell_Shield"
data "StackId" "KFC_SHIELD"
data "StackType" "Ignore"
data "Boosts" "AC(5);IF(IsSpellChildOrVariantFromContext('Projectile_MagicMissile')):DamageReduction(Force,Flat,100)"
data "StatusGroups" "SG_RemoveOnRespec"
data "StatusEffect" "19c84d1e-8de6-4361-88ec-0f64c15d52b1"

new entry "Shout_KFC_Shield"
type "SpellData"
data "SpellType" "Shout"
data "TargetConditions" "Self()"
data "Icon" "PassiveFeature_Shield"
data "DisplayName" "hd2aa6de7g6596g45c4gbcdbg8307d584920f;1"
data "Description" "h59dfaff5gfd53g4de4gba58ge5fd85887972;1"
data "DescriptionParams" "5"
data "TooltipStatusApply" "ApplyStatus(KFC_SHIELD,100,1)"
data "CastTextEvent" "Cast"
data "UseCosts" "ReactionActionPoint:1"
data "SpellAnimation" "9122eb08-93f1-4010-a275-f5ae3ec7c76e,,;,,;2860e825-ec12-4008-8471-d797fc00abc4,,;b6540e92-9e06-4695-9d8e-552d5eac45c2,,;5301d674-b7da-47b6-b4cf-2802ba33a9e9,,;,,;86b3cf93-21fb-4a3d-bed9-97d0a567d084,,;,,;,,"
data "VerbalIntent" "Utility"
data "SpellFlags" "HasSomaticComponent;IsLinkedSpellContainer"
data "InterruptPrototype" "Interrupt_KFC_Shield"

// 不灭金身（欧提路克弹力法球）
new entry "Shout_KFC_ResilientSphere"
type "SpellData"
data "SpellType" "Shout"
data "SpellProperties" "ApplyStatus(SELF,KFC_RESILIENT_SPHERE,100,3)"
data "TooltipStatusApply" "ApplyStatus(KFC_RESILIENT_SPHERE,100,3)"
data "TargetConditions" "Self()"
// 暗影护甲
data "Icon" "Spell_Abjuration_MageArmor"
data "DisplayName" "h174714ebgc630g445dga4d1g0550a18efbec;1"
data "Description" "h1876724fg1229g41e9g9f20g850e5967bf45;1"
data "TooltipPermanentWarnings" "c4da40d6-cfc7-4148-a5e5-5b7cbc41a991"
data "CastSound" "Spell_Cast_Wizard_ResilientSphere_L4to5"
data "TargetSound" "Spell_Impact_Wizard_ResilientSphere_L4to5"
data "PreviewCursor" "Cast"
data "CastTextEvent" "Cast"
data "UseCosts" "ActionPoint:1"
data "SpellAnimation" "03114753-8d91-4c52-8207-728a67cdd59b,,;,,;2bac2431-3048-44e9-ad4a-ca4db0a63104,,;352ab1cc-249f-4d9e-9a42-58148d3658fe,,;8fcb1f19-a84b-486d-81fa-098aaf7cc9be,,;,,;c5bd6ce6-281c-4314-9f74-9f7bb2f4cf03,,;,,;,,"
data "VerbalIntent" "Utility"
data "SpellFlags" "HasSomaticComponent"
data "PrepareEffect" "af787096-8656-4495-a6ce-cbd376578069"
data "CastEffect" "c32a08dc-ebfa-4d8c-bd4b-e21cd1f5f256"
data "TargetEffect" "4075547d-197f-4cb3-94ff-b40a7fd113d4"

new entry "KFC_RESILIENT_SPHERE"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h174714ebgc630g445dga4d1g0550a18efbec;1"
data "Description" "h1876724fg1229g41e9g9f20g850e5967bf45;1"
// 暗影护甲
data "Icon" "Spell_Abjuration_MageArmor"
data "StackId" "KFC_RESILIENT_SPHERE"
data "Boosts" "Invulnerable();ActionResourceMultiplier(Movement,50,0);MovementSpeedLimit(Walk)"
data "StatusPropertyFlags" "IsInvulnerable;DisableInteractions"
data "OnApplyFunctors" "IF(Tagged('WEIGHT_SMALL')):ApplyStatus(RESILIENT_SPHERE_SMALL,100,-1);IF(Tagged('WEIGHT_MEDIUM')):ApplyStatus(RESILIENT_SPHERE_MEDIUM,100,-1);IF(Tagged('WEIGHT_LARGE')):ApplyStatus(RESILIENT_SPHERE_LARGE,100,-1);IF(Tagged('WEIGHT_TINY') or Tagged('WEIGHT_HUGE') or Tagged('WEIGHT_GARGANTUAN')):ApplyStatus(RESILIENT_SPHERE_OVERLAY,100,-1)"
data "StatusGroups" "SG_RemoveOnRespec"
data "StatusEffect" "2419c2ea-a3b6-45e7-8b57-dd6cecf0ec2d"

// 大金刚神力
new entry "Passive_KFC_DaJinGangShenLi"
type "PassiveData"
data "DisplayName" "h5007e0ebg5a58g4da0gbe36g93017b27d17c;1"
data "Description" "ha627cd63g0326g496fg8e26gf87b4593a1e9;1"
data "DescriptionParams" "max(1,StrengthModifier)"
data "ExtraDescription" "hd7c5f3a6ge2a4g4d0cgb46bg5fd49d003347;1"
// 狂暴
data "Icon" "Action_Barbarian_Rage"
data "Properties" "Highlighted"
data "Boosts" "IF(IsWeaponAttack() and IsProficientWithEquippedWeapon()):CharacterWeaponDamage(max(1,StrengthModifier));IF(IsMeleeUnarmedAttack()):CharacterUnarmedDamage(max(1,StrengthModifier));IF(IsRangedUnarmedAttack()):DamageBonus(max(1,StrengthModifier));IF(IsSpell() and IsDamageTypeForce()):DamageBonus(max(1,StrengthModifier));RollBonus(Attack,max(1,StrengthModifier));Reroll(Damage,20,false);Advantage(Ability,Strength)"